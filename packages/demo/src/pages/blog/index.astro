---
import BaseLayout from '@/layouts/BaseLayout.astro';
import BlogCard from '@/components/BlogCard.astro';
import { getSortedPosts } from '@/utils/blog';
import type { CollectionEntry } from 'astro:content';

const posts = await getSortedPosts();

// Function to determine card variant
function getCardVariant(index: number): 'default' | 'featured' | 'minimal' {
  if (index === 0) return 'featured';
  if ((index + 1) % 4 === 0) return 'minimal';
  return 'default';
}
---

<BaseLayout>
  <div class="relative space-y-12 w-full">
    <!-- Header with gradient background and glass effect -->
    <div class="relative -mx-6 -mt-6 mb-12">
      <!-- Gradient Background -->
      <div class="absolute inset-0 bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600 rounded-b-3xl"></div>

      <!-- Floating orbs -->
      <div class="absolute inset-0 overflow-hidden rounded-b-3xl">
        <div class="absolute w-64 h-64 bg-cyan-400/30 rounded-full blur-3xl cs-float cs-anim-infinite" style="top: -20%; right: -10%; animation-duration: 8s;"></div>
        <div class="absolute w-48 h-48 bg-pink-400/30 rounded-full blur-3xl cs-float cs-anim-infinite" style="bottom: -10%; left: -5%; animation-duration: 6s; animation-delay: 2s;"></div>
      </div>

      <!-- Content -->
      <div class="relative text-center space-y-6 px-6 py-16">
        <div class="backdrop-blur-sm p-8 rounded-3xl mx-auto max-w-4xl" style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2);">
          <h1 class="text-5xl sm:text-6xl lg:text-7xl font-bold text-white mb-6 cs-fade-in">
            Blog
          </h1>
          <p class="text-xl sm:text-2xl text-white/90 max-w-3xl mx-auto leading-relaxed cs-fade-in cs-delay-100">
            Entdecke Artikel √ºber Astro, Tailwind CSS, Svelte und moderne Webentwicklung
          </p>

          <!-- Decorative elements -->
          <div class="flex justify-center items-center gap-4 mt-6 opacity-60 cs-fade-in cs-delay-200">
            <div class="h-px bg-gradient-to-r from-transparent via-white to-transparent w-20"></div>
            <div class="w-2 h-2 bg-white rounded-full cs-pulse cs-anim-infinite"></div>
            <div class="h-px bg-gradient-to-r from-transparent via-white to-transparent w-20"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Blog Posts Grid with Atlas styling -->
    <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
      {posts.map((post: CollectionEntry<'blog'>, index: number) => (
        <BlogCard
          title={post.data.title}
          description={post.data.description}
          date={post.data.date}
          author={post.data.author}
          image={post.data.image}
          slug={post.slug}
          tags={post.data.tags}
          variant={getCardVariant(index)}
        />
      ))}
    </div>

    <!-- Empty State with Atlas styling -->
    {posts.length === 0 && (
      <div class="text-center py-16">
        <div class="cs-glass p-12 rounded-3xl mx-auto max-w-md">
          <div class="text-8xl mb-6 animate-bounce">üìù</div>
          <h3 class="text-2xl font-bold cs-gradient-text mb-4">
            Noch keine Blog-Posts
          </h3>
          <p class="text-gray-600 dark:text-gray-300 mb-6">
            Erstelle deinen ersten Blog-Post im
            <code class="cs-glass-sm px-2 py-1 rounded text-sm font-mono">src/content/blog/</code>
            Verzeichnis
          </p>
          <div class="cs-orb cs-orb-sm opacity-30 animate-pulse mx-auto"></div>
        </div>
      </div>
    )}
  </div>
</BaseLayout>
