---
import BaseLayout from '@/layouts/BaseLayout.astro';
import BlogCard from '@astro-v5/shared/components/BlogCard.astro';
import { getSortedPosts } from '@/utils/blog';
import type { CollectionEntry } from 'astro:content';

const posts = await getSortedPosts();

// Function to determine card variant
function getCardVariant(index: number): 'default' | 'featured' | 'minimal' {
  if (index === 0) return 'featured';
  if ((index + 1) % 4 === 0) return 'minimal';
  return 'default';
}
---

<BaseLayout>
  <div class="relative space-y-12 w-full">
    <!-- Simple Header -->
    <div class="text-center space-y-4">
      <h1 class="text-4xl sm:text-5xl font-bold text-slate-900 dark:text-white">
        Blog
      </h1>
      <p class="text-lg text-slate-600 dark:text-slate-300 max-w-2xl mx-auto">
        Entdecke Artikel √ºber Astro, Tailwind CSS, Svelte und moderne Webentwicklung
      </p>
    </div>

    <!-- Blog Posts Grid with Atlas styling -->
    <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
      {posts.map((post: CollectionEntry<'blog'>, index: number) => (
        <BlogCard
          title={post.data.title}
          description={post.data.description}
          date={post.data.date}
          author={post.data.author}
          image={post.data.image}
          slug={post.slug}
          tags={post.data.tags}
          variant={getCardVariant(index)}
        />
      ))}
    </div>

    <!-- Empty State with Atlas styling -->
    {posts.length === 0 && (
      <div class="text-center py-16">
        <div class="cs-glass p-12 rounded-3xl mx-auto max-w-md">
          <div class="text-8xl mb-6 animate-bounce">üìù</div>
          <h3 class="text-2xl font-bold cs-gradient-text mb-4">
            Noch keine Blog-Posts
          </h3>
          <p class="text-gray-600 dark:text-gray-300 mb-6">
            Erstelle deinen ersten Blog-Post im
            <code class="cs-glass-sm px-2 py-1 rounded text-sm font-mono">src/content/blog/</code>
            Verzeichnis
          </p>
          <div class="cs-orb cs-orb-sm opacity-30 animate-pulse mx-auto"></div>
        </div>
      </div>
    )}
  </div>
</BaseLayout>
