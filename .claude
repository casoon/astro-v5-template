# Astro v5 Template - Projektrichtlinien

## üéØ Projektzweck

Dieses Template dient als professionelle, saubere Grundlage f√ºr Astro-basierte Webprojekte. Es bietet drei verschiedene Stufen (blank, base, demo) f√ºr unterschiedliche Projektanforderungen.

## ‚ôø WCAG-Verpflichtung

**Dieses Projekt verpflichtet sich zu WCAG 2.1 Level AA Konformit√§t.**

### Accessibility-Anforderungen

Alle Komponenten und Features m√ºssen folgende Standards erf√ºllen:

#### 1. Wahrnehmbarkeit (Perceivable)
- **1.1 Textalternativen**: Alle Bilder ben√∂tigen aussagekr√§ftige `alt`-Attribute
- **1.3 Anpassbar**: Semantisches HTML verwenden (nav, section, article, header, footer)
- **1.4 Unterscheidbar**:
  - Farbkontrast mindestens 4.5:1 f√ºr normalen Text
  - Farbkontrast mindestens 3:1 f√ºr gro√üe Texte (18pt+ oder 14pt+ bold)
  - Text muss auf 200% zoombar sein ohne Funktionsverlust
  - Keine Information nur √ºber Farbe vermitteln

#### 2. Bedienbarkeit (Operable)
- **2.1 Tastaturzug√§nglich**: Alle Funktionen per Tastatur erreichbar
- **2.2 Ausreichend Zeit**: Keine zeitbasierten Einschr√§nkungen ohne Alternative
- **2.4 Navigierbar**:
  - Skip-Links f√ºr Hauptinhalt
  - Eindeutige, beschreibende Seitentitel
  - Logische Tab-Reihenfolge
  - Sichtbare Fokus-Indikatoren
  - Eindeutige Link-Texte (keine "hier klicken")

#### 3. Verst√§ndlichkeit (Understandable)
- **3.1 Lesbar**: `lang`-Attribut auf html-Element
- **3.2 Vorhersehbar**: Konsistente Navigation und Identifikation
- **3.3 Hilfestellung bei der Eingabe**:
  - Klare Fehlermeldungen
  - Labels f√ºr alle Formularfelder
  - Eingabehilfen und Validierung

#### 4. Robustheit (Robust)
- **4.1 Kompatibel**:
  - Valides HTML
  - Korrekte ARIA-Attribute
  - Name, Role, Value f√ºr alle UI-Komponenten

### Verpflichtende ARIA-Patterns

- **Dialoge/Modals**: `role="dialog"`, `aria-modal="true"`, `aria-labelledby`
- **Buttons**: Immer `<button>` verwenden, nie `<div onclick>`, `aria-label` f√ºr Icon-Buttons
- **Navigation**: `<nav>` mit `aria-label` zur Unterscheidung mehrerer Navigationen
- **Formulare**: Labels mit `for`-Attribut, `aria-describedby` f√ºr Hilfetext, `aria-invalid` f√ºr Fehler
- **Dynamischer Content**: `aria-live` f√ºr wichtige Updates

### Testing-Anforderungen

Vor jedem Release m√ºssen folgende Tests bestanden werden:
- Keyboard-Navigation Test (Tab, Enter, Escape, Arrow Keys)
- Screen Reader Test (NVDA, JAWS, oder VoiceOver)
- Color Contrast Analysis (via WebAIM oder √§hnlich)
- Automated Accessibility Scan (axe, Lighthouse Accessibility Score > 90)

## üèóÔ∏è Architektur-Prinzipien

### 1. Template-Philosophie
- **Minimal, nicht maximal**: Nur notwendige Features im Template
- **L√∂schbar statt konfigurierbar**: Entwickler k√∂nnen einfach entfernen, was sie nicht brauchen
- **Beispiele zeigen**: Template demonstriert Best Practices, ist aber nicht produktionsfertig
- **Drei Stufen**: blank (minimal) ‚Üí base (komponenten-reich) ‚Üí demo (vollst√§ndig)

### 2. Code-Qualit√§t

#### TypeScript
```typescript
// ‚úÖ RICHTIG: Strikte Typisierung
interface Props {
  title: string;
  description?: string;
  variant?: 'default' | 'dark' | 'strong';
}

// ‚ùå FALSCH: any verwenden
const doSomething = (data: any) => { ... }
```

#### Komponenten-Struktur
```astro
---
// 1. Interfaces/Types
export interface Props {
  // ...
}

// 2. Props destructuring mit Defaults
const { title, variant = 'default' } = Astro.props;

// 3. Logic/Computations
const classes = cn('base-class', variantClasses[variant]);
---

<!-- 4. Template -->
<div class={classes}>
  <slot />
</div>

<style>
  /* 5. Scoped Styles (nur wenn n√∂tig) */
</style>
```

#### Naming Conventions
- **Komponenten**: PascalCase (`HeroSection.astro`, `BlogCard.astro`)
- **Utilities**: camelCase (`formatDate.ts`, `cn.ts`)
- **CSS Classes**: kebab-case via Tailwind
- **API Routes**: kebab-case (`contact.ts`, `newsletter.ts`)

### 3. Performance-Standards

- **Images**: Immer `OptimizedImage.astro` verwenden, nie `<img>` direkt
- **Web Vitals Ziele**:
  - LCP < 2.5s
  - FID < 100ms
  - CLS < 0.1
  - Lighthouse Score > 90
- **Bundle Size**: JavaScript so minimal wie m√∂glich
- **Lazy Loading**: Alle Bilder au√üer above-the-fold

## üì¶ Workspace-Struktur

```
packages/
‚îú‚îÄ‚îÄ shared/       # Design System, Utilities (wird von allen importiert)
‚îú‚îÄ‚îÄ blank/        # Minimalstes Template (nur Layout + SEO)
‚îú‚îÄ‚îÄ base/         # Produktionsreife Basis (alle Komponenten)
‚îî‚îÄ‚îÄ demo/         # Vollst√§ndige Demo (Beispiel-Content)
```

### Dependency-Regel
- `blank` ‚Üí importiert nur `shared`
- `base` ‚Üí importiert nur `shared`
- `demo` ‚Üí importiert nur `shared`
- **NIEMALS**: Cross-Package Imports zwischen blank/base/demo

## üé® Styling-Guidelines

### Tailwind CSS Prinzipien
- **Utility-First**: Tailwind Classes bevorzugen
- **Custom CSS nur wenn n√∂tig**: F√ºr Animationen, komplexe Layouts
- **Dark Mode**: Immer `dark:` Varianten mitdenken
- **Responsive**: Mobile-First (sm, md, lg, xl, 2xl)

### Design Tokens
```css
/* ‚úÖ RICHTIG: CSS Variables verwenden */
color: var(--color-primary-500);
transition: var(--transition-all);

/* ‚ùå FALSCH: Hardcoded values */
color: #3b82f6;
transition: all 0.3s ease;
```

### Color Contrast
- **Normale Texte**: Minimum 4.5:1 Kontrast
- **Gro√üe Texte**: Minimum 3:1 Kontrast
- **UI-Komponenten**: Minimum 3:1 Kontrast
- **Pr√ºfung**: WebAIM Contrast Checker verwenden

## üîß Development Workflow

### 1. Vor dem Entwickeln
```bash
# Dependencies installieren
pnpm install

# Entwicklungsserver starten
pnpm dev              # Demo
pnpm dev:blank       # Blank Template
pnpm dev:base        # Base Template
```

### 2. W√§hrend der Entwicklung
```bash
# Type-Checking (kontinuierlich im Hintergrund)
pnpm type-check

# Linting
pnpm check

# Formatting
pnpm format
```

### 3. Vor dem Commit
```bash
# Automatisch via Husky/lint-staged:
# - Biome linting
# - Prettier formatting
# - TypeScript checking (auf ge√§nderten Dateien)
```

### 4. Build & Validation
```bash
# Vollst√§ndiger Build
pnpm build

# Schneller Build (ohne Type-Check)
pnpm build:fast

# Spezifisches Package
pnpm build:blank
pnpm build:base
pnpm build:demo
```

## üìù Komponenten-Entwicklung

### Neue Komponente erstellen

1. **Pr√ºfen**: Geh√∂rt sie in `shared` (wiederverwendbar) oder package-spezifisch?
2. **Props Interface**: Immer `export interface Props` definieren
3. **Accessibility**: ARIA-Attributes, Semantic HTML, Keyboard Support
4. **TypeScript**: Strikte Typisierung, keine `any`
5. **Responsive**: Mobile-First Design
6. **Dark Mode**: `dark:` Varianten f√ºr alle visuellen Elemente
7. **Documentation**: JSDoc f√ºr komplexe Props

### Beispiel: Accessible Button Component
```astro
---
export interface Props {
  /** Button text or content */
  children?: string;
  /** Visual variant */
  variant?: 'primary' | 'secondary' | 'ghost';
  /** Size variant */
  size?: 'sm' | 'md' | 'lg';
  /** Disabled state */
  disabled?: boolean;
  /** ARIA label for icon-only buttons */
  ariaLabel?: string;
  /** Button type */
  type?: 'button' | 'submit' | 'reset';
}

const {
  variant = 'primary',
  size = 'md',
  disabled = false,
  ariaLabel,
  type = 'button'
} = Astro.props;
---

<button
  type={type}
  disabled={disabled}
  aria-label={ariaLabel}
  class={cn(
    'button-base',
    variantClasses[variant],
    sizeClasses[size],
    disabled && 'opacity-50 cursor-not-allowed'
  )}
>
  <slot />
</button>
```

## üß™ Testing-Anforderungen

### Manuelle Tests (vor jedem Release)
- [ ] Keyboard-Navigation funktioniert
- [ ] Dark Mode Toggle funktioniert
- [ ] Alle Links funktionieren
- [ ] Formulare validieren korrekt
- [ ] Mobile Responsiveness (Chrome DevTools)
- [ ] Screen Reader Test (mindestens ein Tool)

### Automatisierte Tests
```bash
# Lighthouse Test (Performance, Accessibility, SEO)
pnpm lighthouse

# TypeScript Type Checking
pnpm type-check

# Linting
pnpm check
```

## üöÄ Build & Deployment

### Environment Variables
Alle Packages nutzen validierte Environment Variables (siehe `env.ts`):

```env
# Required
PUBLIC_SITE_URL=https://example.com

# Optional but recommended
PUBLIC_SITE_NAME=My Awesome Site
PUBLIC_AUTHOR=Your Name
PUBLIC_LOCALE=de
PUBLIC_ENABLE_ANALYTICS=false
PUBLIC_ENABLE_DARK_MODE=true
```

### Build-Validierung
```bash
# Config validieren
pnpm validate:config

# Full build mit allen checks
pnpm build

# Lighthouse Score pr√ºfen
pnpm lighthouse
```

## üìö Best Practices

### Do's ‚úÖ
- Semantic HTML verwenden (`<nav>`, `<main>`, `<article>`)
- TypeScript strict mode nutzen
- Props interfaces exportieren
- Mobile-first Design
- Dark mode support
- Keyboard navigation
- ARIA labels f√ºr interaktive Elemente
- Bilder optimieren (WebP, AVIF)
- Environment Variables validieren
- Komponenten dokumentieren

### Don'ts ‚ùå
- `any` Type verwenden
- Inline styles (au√üer f√ºr dynamische Values)
- `<div>` statt `<button>` f√ºr Klickbares
- Hardcoded URLs oder Strings
- Fehlende alt-Attribute f√ºr Bilder
- Console.logs im Production-Code
- Unvalidierte User-Inputs
- Missing TypeScript types
- Undokumentierte komplexe Logic
- Broken accessibility features

## üîí Security-Richtlinien

### Input Validation
```typescript
// ‚úÖ RICHTIG: Zod validation
import { z } from 'zod';

const contactSchema = z.object({
  email: z.string().email(),
  message: z.string().min(10).max(1000),
});
```

### API Routes
```typescript
// ‚úÖ RICHTIG: Error handling, validation
export const POST: APIRoute = async ({ request }) => {
  try {
    const data = await request.json();
    const validated = schema.parse(data);
    // Process...
    return new Response(JSON.stringify({ success: true }), {
      status: 200,
      headers: { 'Content-Type': 'application/json' }
    });
  } catch (error) {
    return new Response(JSON.stringify({ error: 'Invalid input' }), {
      status: 400
    });
  }
};
```

### XSS Prevention
- Astro escaped automatisch
- Bei `set:html` IMMER sanitizen
- User Input NIEMALS direkt in HTML

## üìñ Dokumentation

### README-Anforderungen
Jedes Package ben√∂tigt:
- Kurze Beschreibung
- Installation Steps
- Development Commands
- Build Instructions
- Features Liste
- Customization Guide

### Code-Dokumentation
```typescript
/**
 * Optimized image component with responsive sizes and modern formats
 * @component
 * @example
 * ```astro
 * <OptimizedImage
 *   src="hero.jpg"
 *   alt="Hero image"
 *   sizes="(max-width: 768px) 100vw, 50vw"
 * />
 * ```
 */
```

## üéØ Template-Spezifische Regeln

### Blank Package
- **Minimal**: Nur Layout + SEO + 404
- **Keine Komponenten**: Nur absolut notwendige
- **Keine Beispiele**: Nur Struktur
- **Ziel**: Schnellster Start f√ºr erfahrene Entwickler

### Base Package
- **Produktionsreif**: Alle Komponenten einsatzbereit
- **Ein Beispiel pro Feature**: Blog, Form, etc.
- **Dokumentiert**: Jede Komponente erkl√§rt
- **Ziel**: Schneller Projektstart mit Best Practices

### Demo Package
- **Showcase**: Alle Features demonstriert
- **Mehrere Beispiele**: 4+ Blog Posts, verschiedene Komponenten
- **Live Preview**: Deploybar als Referenz
- **Ziel**: Zeigen was m√∂glich ist

## üîÑ Wartung & Updates

### Version Updates
- **Astro**: Updates zeitnah einspielen, Breaking Changes dokumentieren
- **Dependencies**: Monatlich pr√ºfen, Security Updates sofort
- **Node.js**: LTS Version verwenden, in package.json festlegen

### Breaking Changes
Bei Breaking Changes:
1. CHANGELOG.md aktualisieren
2. Migration Guide schreiben
3. Beispiele updaten
4. Version Bump (Semantic Versioning)

## üìû Support & Contribution

### Issues Melden
- Template-Bug: GitHub Issue mit Reproduktion
- Accessibility-Problem: High Priority, mit WCAG-Referenz
- Feature Request: Mit Use Case und Begr√ºndung

### Contributions
- Fork ‚Üí Feature Branch ‚Üí PR
- Alle Tests m√ºssen passen
- Accessibility-Konformit√§t pr√ºfen
- Dokumentation aktualisieren

---

**Diese Richtlinien sind verbindlich f√ºr alle Entwicklungen am Template.**
**Bei Fragen oder Unklarheiten: Lieber fragen als falsch implementieren!**
